/*
 * @Author: Sophie
 * @email: bajie615@126.com
 * @Date: 2020-01-15 19:55:30
 * @Description: file content
 */


function initCanvas(canvasId){
     // init Canvas
     var canvas = document.getElementById(canvasId);
     canvas.width = canvas.clientWidth;
     canvas.height = canvas.clientHeight;
     canvas.addEventListener("touchmove",responseToMouse,false);
     /** @type {WebGLRenderingContext} */
     var gl = canvas.getContext("webgl");
     if (gl === null){
         gl = canvas.getContext("experimental-webgl");
     }
     if (gl === null){
         alert("Unable to initialize the webgl context");
     }
     gl.enable(gl.BLEND);
     gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
     /** @type {WebGLRenderingContext} */
     return  gl;    
}
function responseToMouse(
    /**@type {TouchEvent} */
    ev){
        console.log("move");
        var tc = ev.touches[0];
        var x = tc.clientX;
        var y = tc.clientY;
        // mdg.mat.setUniform("u_mouse",UTypeEnumn.Vec2,[x,y]);
        // mdg.scene.requireUpdate();
        // //scene.require
        // console.log(x,y);


}

function initCamera(asp){
    console.log("camera,asp:",asp);
    var cam = new Mad3D.Camera();
    /**@type {Transform} */
    var transform  = cam.transform;
    cam.setFov(45);
    cam.setFar(100.0);
    cam.setNear(0.1);
    cam.setAsp(asp);
    transform.setPosition(0,0,8);
    //transform.rotate(0,0,0);

    return cam;
}
var mdg = {};


function createPolygonEntity(){
   
    // create Mesh:
    //var mesh =createSqModelMesh();

   // var mesh = MeshUtil.createPlane(3,3,2.0);
  //var mesh =  MeshUtil.createCameraPlane(cam);
//   var colors = [1.0,1.0,1.0,1.0,
//     1.0,0.0,0.0,1.0,
//     0.0,1.0,0.0,1.0,
//     0.0,0.0,1.0,1.0];
// var mid = [0.0, -2.0];


//   var colors = [2.5,1.6,1.0,1.0,
//                 2.45,1.55,1.0,1.0,
//                 2.6,1.5,1.0,1.0,
//                 2.48,1.1,1.0,1.0];


// var a = 0.5; var b = 0.5; var c = 0.0; 
// var posArr = [
//     // Front face
//     -0.5, -0.5,  c,
//     0.5, 0.4,  c,
//     0.0,  0.6,  c,
//     -0.5,  0.5,  c,
// ];

var mid = [0.0, 0.0];


var c = 0.0; 
// var inSize = 4; var outSize =4;
// var posArr = [
//     // Front face
//     -1, -1,  c,
//     0, -1,  c,
//     1, -1.3, c,
//     2, -0.9, c,
//     1,  1,  c,
//     -1,  1.9,  c,
//     -2, 1.1, c,
//     -3, 1.4, c,

// ];
// var posArr = [
//         // inner
//         -3, -1,  c,
//         -2, -1,  c,
//         -1, -1.3, c,
//         1, -0.9, c,
        
        
        
//         //out
//         1,  1,  c,
//         -1,  3.9, c,

//         -2, 1.1, c,
//         -3, 1.4, c,
    
//     ];
//     var inInds = [0,1,2,3];
//     var outInds = [4,5,6,7];
// //var indices = [0,1,7,1,6,7,1,5,6,1,2,5,2,4,5,2,3,4];
// var indices = [0,1,7,1,6,7,1,2,6,4,5,6,2,4,6,2,3,4];
//var indices  = [4,5,6];

// var posArr = [
//     // Front face
//     -0.5, -0.5,  c,
//     0.5, 0.4,  c,
//     0.0,  0.6,  c,
//     -0.5,  0.5,  c,
// ];


// var posArr = [
//     // inner
//     -3, -1,  c,
//     -2, -1,  c,
//     -1, -1.3, c,
//     1, -0.9, c,
//     1.5, -2.0, c,
//     2.0, -2.7, c,
//     3.0, - 4.0, c,
//     1.0, -7.0, c,
//     -3.5, -9,c,
//     -3, -1, c,

//     //out
//     -3, 1.4, c,
//     -2, 1.1, c,
//     -1,  3.9, c,
//     1,  1,  c,
//     2.5, -2.0, c,
//     3.0, -2.7, c,
//     3.5, - 5.0, c,
//     2.0, -8.0, c,
//     -4.5, -10,c,
//     -3, 1.4, c,

// ];
// var inInds = [0,1,2,3,4,5,6,7];
// var outInds = [10,11,12,13,14,15,16];

// var posArr = [
//     // inner
//     -5, -5,  c,
//     5, -5,  c,
//     5, -6, c,
//     5, 5, c,
//     -5, 5, c,
//     -5,-5, c,

//     //out
//     -7, -7,  c,
//     7, -7,  c,
//     7, -9, c,
//     7, 7, c,
//     -7, 7, c,
//     -7,-7, c

// ];
// var inInds = [0,1,2,3,4,5];
// var outInds = [6,7,8,9,10,11];


var posArr=[
0.0,0.0,0,
28.934600000000188,28.934600000000188,0,
-60.53959999999989,-60.53959999999989,0,
,0.0,0.0,0,
-4.341399999999851,-4.341399999999851,0,
36.140100000000075,36.140100000000075,0,
-72.55809999999983,-72.55809999999983,0,
-4.341399999999851,-4.341399999999851,0
];

var inInds=[0,1,2,3];
var outInds=[4 ,5 ,6 ,7];
var posArr=[
    0.0,0.0,0,
    0.7421999999998263,0.7421999999998263,0,
    1.7214000000002727,1.7214000000002727,0,
    2.689200000000369,2.689200000000369,0,
    3.397300000000314,3.397300000000314,0,
    4.24069999999972,4.24069999999972,0,
    5.567599999999828,5.567599999999828,0,
    6.880799999999709,6.880799999999709,0,
    7.682900000000359,7.682900000000359,0,
    7.772800000000046,7.772800000000046,0,
    7.809499999999758,7.809499999999758,0,
    7.8322,7.8322,0,
    7.880300000000062,7.880300000000062,0,
    8.639999999999759,8.639999999999759,0,
    9.959500000000077,9.959500000000077,0,
    11.294900000000041,11.294900000000041,0,
    12.102099999999893,12.102099999999893,0,
    12.205999999999761,12.205999999999761,0,
    12.336100000000272,12.336100000000272,0,
    12.465500000000418,12.465500000000418,0,
    12.567200000000156,12.567200000000156,0,
    13.368299999999778,13.368299999999778,0,
    14.68890000000016,14.68890000000016,0,
    16.048400000000385,16.048400000000385,0,
    16.966000000000037,16.966000000000037,0,
    19.47460000000021,19.47460000000021,0,
    23.376400000000075,23.376400000000075,0,
    27.286399999999844,27.286399999999844,0,
    29.819700000000182,29.819700000000182,0,
    30.204700000000173,30.204700000000173,0,
    30.78179999999975,30.78179999999975,0,
    31.339499999999987,31.339499999999987,0,
    31.66620000000009,31.66620000000009,0,
    31.974800000000414,31.974800000000414,0,
    32.269500000000306,32.269500000000306,0,
    32.57720000000006,32.57720000000006,0,
    32.92520000000039,32.92520000000039,0,
    33.32979999999992,33.32979999999992,0,
    34.020900000000154,34.020900000000154,0,
    34.74310000000003,34.74310000000003,0,
    35.2409999999999,35.2409999999999,0,
    35.56870000000032,35.56870000000032,0,
    36.07459999999989,36.07459999999989,0,
    36.56819999999996,36.56819999999996,0,
    36.859400000000164,36.859400000000164,0,
    37.21180000000004,37.21180000000004,0,
    36.472599999999744,36.472599999999744,0,
    35.661699999999996,35.661699999999996,0,
    35.798900000000344,35.798900000000344,0,
    36.50599999999997,36.50599999999997,0,
    37.753899999999874,37.753899999999874,0,
    38.95040000000023,38.95040000000023,0,
    39.502999999999844,39.502999999999844,0,
    37.8618000000003,37.8618000000003,0,
    34.09460000000024,34.09460000000024,0,
    30.258800000000008,30.258800000000008,0,
    28.411599999999737,28.411599999999737,0,
    29.055300000000273,29.055300000000273,0,
    30.641400000000374,30.641400000000374,0,
    32.37960000000015,32.37960000000015,0,
    33.47929999999977,33.47929999999977,0,
    33.5601000000004,33.5601000000004,0,
    33.678700000000106,33.678700000000106,0,
    33.79010000000022,33.79010000000022,0,
    33.84890000000027,33.84890000000027,0,
    33.84319999999974,33.84319999999974,0,
    33.725600000000355,33.725600000000355,0,
    33.581099999999964,33.581099999999964,0,
    33.49490000000017,33.49490000000017,0,
    33.45979999999997,33.45979999999997,0,
    33.41599999999971,33.41599999999971,0,
    33.375600000000105,33.375600000000105,0,
    33.351100000000145,33.351100000000145,0,
    33.34860000000006,33.34860000000006,0,
    33.348000000000155,33.348000000000155,0,
    33.33760000000012,33.33760000000012,0,
    33.30610000000007,33.30610000000007,0,
    32.35510000000019,32.35510000000019,0,
    30.659200000000197,30.659200000000197,0,
    29.01910000000001,29.01910000000001,0,
    28.235600000000005,28.235600000000005,0,
    28.359100000000126,28.359100000000126,0,
    28.64500000000021,28.64500000000021,0,
    28.912799999999805,28.912799999999805,0,
    28.98180000000039,28.98180000000039,0,
    28.560999999999837,28.560999999999837,0,
    27.772900000000078,27.772900000000078,0,
    26.989000000000374,26.989000000000374,0,
    26.580700000000235,26.580700000000235,0,
    26.819000000000415,26.819000000000415,0,
    27.546199999999743,27.546199999999743,0,
    28.29850000000036,28.29850000000036,0,
    28.612199999999888,28.612199999999888,0,
    28.430500000000336,28.430500000000336,0,
    28.05669999999978,28.05669999999978,0,
    27.677500000000066,27.677500000000066,0,
    27.47980000000041,27.47980000000041,0,
    27.676600000000207,27.676600000000207,0,
    28.277100000000388,28.277100000000388,0,
    28.842699999999866,28.842699999999866,0,
    28.934600000000188,28.934600000000188,0,
    28.32650000000001,28.32650000000001,0,
    27.208300000000207,27.208300000000207,0,
    26.04299999999995,26.04299999999995,0,
    25.293800000000033,25.293800000000033,0,
    25.071600000000416,25.071600000000416,0,
    24.741399999999913,24.741399999999913,0,
    24.425099999999844,24.425099999999844,0,
    24.244999999999806,24.244999999999806,0,
    24.001400000000217,24.001400000000217,0,
    23.838400000000348,23.838400000000348,0,
    23.78179999999972,23.78179999999972,0,
    23.85719999999978,23.85719999999978,0,
    24.326100000000395,24.326100000000395,0,
    25.1891999999998,25.1891999999998,0,
    26.032800000000123,26.032800000000123,0,
    26.44340000000014,26.44340000000014,0,
    26.14590000000021,26.14590000000021,0,
    25.248599999999755,25.248599999999755,0,
    24.084400000000272,24.084400000000272,0,
    22.986000000000217,22.986000000000217,0,
    22.93379999999985,22.93379999999985,0,
    22.85669999999982,22.85669999999982,0,
    22.77920000000009,22.77920000000009,0,
    22.725799999999907,22.725799999999907,0,
    19.324499999999745,19.324499999999745,0,
    14.16240000000002,14.16240000000002,0,
    9.171599999999813,9.171599999999813,0,
    6.284399999999835,6.284399999999835,0,
    6.176800000000071,6.176800000000071,0,
    6.315299999999979,6.315299999999979,0,
    6.428400000000067,6.428400000000067,0,
    6.244699999999881,6.244699999999881,0,
    5.858599999999825,5.858599999999825,0,
    5.248300000000228,5.248300000000228,0,
    4.628699999999952,4.628699999999952,0,
    4.214300000000293,4.214300000000293,0,
    0.9990999999999417,0.9990999999999417,0,
    -3.919400000000195,-3.919400000000195,0,
    -8.836900000000014,-8.836900000000014,0,
    -12.048999999999666,-12.048999999999666,0,
    -13.069199999999626,-13.069199999999626,0,
    -14.587900000000076,-14.587900000000076,0,
    -16.10689999999977,-16.10689999999977,0,
    -17.128100000000046,-17.128100000000046,0,
    -17.270500000000055,-17.270500000000055,0,
    -17.488600000000076,-17.488600000000076,0,
    -17.70610000000019,-17.70610000000019,0,
    -17.846899999999977,-17.846899999999977,0,
    -18.973599999999635,-18.973599999999635,0,
    -20.599299999999943,-20.599299999999943,0,
    -22.17249999999993,-22.17249999999993,0,
    -23.141599999999585,-23.141599999999585,0,
    -23.750900000000286,-23.750900000000286,0,
    -24.54439999999991,-24.54439999999991,0,
    -25.381699999999796,-25.381699999999796,0,
    -26.122600000000062,-26.122600000000062,0,
    -28.90949999999961,-28.90949999999961,0,
    -33.24819999999988,-33.24819999999988,0,
    -37.47729999999976,-37.47729999999976,0,
    -39.93600000000015,-39.93600000000015,0,
    -40.030300000000096,-40.030300000000096,0,
    -40.03049999999959,-40.03049999999959,0,
    -40.0109999999998,-40.0109999999998,0,
    -40.04589999999979,-40.04589999999979,0,
    -40.49059999999969,-40.49059999999969,0,
    -41.284900000000135,-41.284900000000135,0,
    -42.129500000000064,-42.129500000000064,0,
    -42.72489999999962,-42.72489999999962,0,
    -43.52669999999961,-43.52669999999961,0,
    -44.80530000000016,-44.80530000000016,0,
    -46.06390000000005,-46.06390000000005,0,
    -46.805599999999714,-46.805599999999714,0,
    -47.052200000000255,-47.052200000000255,0,
    -47.30649999999983,-47.30649999999983,0,
    -47.51759999999976,-47.51759999999976,0,
    -47.634399999999744,-47.634399999999744,0,
    -47.698299999999705,-47.698299999999705,0,
    -47.762699999999825,-47.762699999999825,0,
    -47.788099999999645,-47.788099999999645,0,
    -47.734700000000174,-47.734700000000174,0,
    -46.434599999999904,-46.434599999999904,0,
    -44.087499999999835,-44.087499999999835,0,
    -41.90699999999978,-41.90699999999978,0,
    -41.10700000000023,-41.10700000000023,0,
    -43.89499999999984,-43.89499999999984,0,
    -49.49810000000028,-49.49810000000028,0,
    -55.31649999999999,-55.31649999999999,0,
    -58.74999999999986,-58.74999999999986,0,
    -58.992800000000045,-58.992800000000045,0,
    -59.24089999999964,-59.24089999999964,0,
    -59.430900000000264,-59.430900000000264,0,
    -59.49939999999998,-59.49939999999998,0,
    -58.993199999999746,-58.993199999999746,0,
    -57.94440000000023,-57.94440000000023,0,
    -56.9383000000002,-56.9383000000002,0,
    -56.560299999999586,-56.560299999999586,0,
    -57.220099999999974,-57.220099999999974,0,
    -58.5484000000001,-58.5484000000001,0,
    -59.87739999999988,-59.87739999999988,0,
    -60.53959999999989,-60.53959999999989,0,
    -60.42360000000002,-60.42360000000002,0,
    -60.076500000000266,-60.076500000000266,0,
    -59.665700000000044,-59.665700000000044,0,
    -59.35890000000015,-59.35890000000015,0,
    -58.93469999999965,-58.93469999999965,0,
    -58.233700000000255,-58.233700000000255,0,
    -57.549900000000065,-57.549900000000065,0,
    -57.17720000000028,-57.17720000000028,0,
    -57.16899999999967,-57.16899999999967,0,
    -57.18559999999968,-57.18559999999968,0,
    -57.20809999999972,-57.20809999999972,0,
    -57.21799999999959,-57.21799999999959,0,
    -57.07669999999965,-57.07669999999965,0,
    -56.806499999999716,-56.806499999999716,0,
    -56.578700000000026,-56.578700000000026,0,
    -56.5646000000001,-56.5646000000001,0,
    -57.260300000000086,-57.260300000000086,0,
    -58.570600000000184,-58.570600000000184,0,
    -59.91700000000009,-59.91700000000009,0,
    -60.720899999999745,-60.720899999999745,0,
    -60.84519999999998,-60.84519999999998,0,
    -61.00629999999967,-61.00629999999967,0,
    -61.13539999999986,-61.13539999999986,0,
    -61.16400000000013,-61.16400000000013,0,
    -60.76720000000009,-60.76720000000009,0,
    -59.990700000000174,-59.990700000000174,0,
    -59.163199999999705,-59.163199999999705,0,
    -58.61319999999992,-58.61319999999992,0,
    -58.103599999999744,-58.103599999999744,0,
    -57.31049999999982,-57.31049999999982,0,
    -56.58290000000008,-56.58290000000008,0,
    -56.269499999999795,-56.269499999999795,0,
    -56.644399999999706,-56.644399999999706,0,
    -57.45509999999996,-57.45509999999996,0,
    -58.25880000000012,-58.25880000000012,0,
    -58.61269999999976,-58.61269999999976,0,
    -58.22330000000022,-58.22330000000022,0,
    -57.36249999999998,-57.36249999999998,0,
    -56.4312000000001,-56.4312000000001,0,
    -55.83019999999976,-55.83019999999976,0,
    -54.05760000000015,-54.05760000000015,0,
    -51.39089999999982,-51.39089999999982,0,
    -48.79979999999975,-48.79979999999975,0,
    -47.254099999999966,-47.254099999999966,0,
    -46.93380000000005,-46.93380000000005,0,
    -46.577800000000025,-46.577800000000025,0,
    -46.17679999999993,-46.17679999999993,0,
    -45.72149999999979,-45.72149999999979,0,
    -43.95839999999964,-43.95839999999964,0,
    -41.08090000000004,-41.08090000000004,0,
    -38.21760000000012,-38.21760000000012,0,
    -36.49739999999966,-36.49739999999966,0,
    -36.39009999999985,-36.39009999999985,0,
    -36.343800000000215,-36.343800000000215,0,
    -36.3233000000001,-36.3233000000001,0,
    -36.29409999999993,-36.29409999999993,0,
    -36.08720000000005,-36.08720000000005,0,
    -35.73299999999975,-35.73299999999975,0,
    -35.34739999999985,-35.34739999999985,0,
    -35.045799999999616,-35.045799999999616,0,
    -34.64400000000012,-34.64400000000012,0,
    -33.97889999999961,-33.97889999999961,0,
    -33.27120000000008,-33.27120000000008,0,
    -32.741699999999696,-32.741699999999696,0,
    -31.881099999999662,-31.881099999999662,0,
    -30.616400000000255,-30.616400000000255,0,
    -29.349599999999754,-29.349599999999754,0,
    -28.4829000000002,-28.4829000000002,0,
    -24.51289999999986,-24.51289999999986,0,
    -18.698200000000043,-18.698200000000043,0,
    -13.050700000000148,-13.050700000000148,0,
    -9.582499999999783,-9.582499999999783,0,
    -9.289499999999862,-9.289499999999862,0,
    -8.9221000000002,-8.9221000000002,0,
    -8.53570000000019,-8.53570000000019,0,
    -8.18609999999964,-8.18609999999964,0,
    -6.554799999999972,-6.554799999999972,0,
    -4.110500000000172,-4.110500000000172,0,
    -1.657499999999601,-1.657499999999601,0,
    0.0,0.0,0,
    -4.341399999999851,-4.341399999999851,0,
    -3.6737999999999715,-3.6737999999999715,0,
    -2.6412000000000546,-2.6412000000000546,0,
    -1.5746000000000038,-1.5746000000000038,0,
    -0.8046999999997695,-0.8046999999997695,0,
    0.5316999999998018,0.5316999999998018,0,
    2.531100000000208,2.531100000000208,0,
    4.512900000000286,4.512900000000286,0,
    5.79620000000034,5.79620000000034,0,
    6.856400000000207,6.856400000000207,0,
    8.427600000000268,8.427600000000268,0,
    10.01449999999977,10.01449999999977,0,
    11.12150000000014,11.12150000000014,0,
    11.522899999999936,11.522899999999936,0,
    12.015600000000148,12.015600000000148,0,
    12.477400000000216,12.477400000000216,0,
    12.785500000000383,12.785500000000383,0,
    15.996799999999922,15.996799999999922,0,
    20.91569999999976,20.91569999999976,0,
    25.749700000000075,25.749700000000075,0,
    28.706100000000134,28.706100000000134,0,
    29.044999999999987,29.044999999999987,0,
    29.48209999999989,29.48209999999989,0,
    29.964700000000022,29.964700000000022,0,
    30.440399999999812,30.440399999999812,0,
    31.700399999999718,31.700399999999718,0,
    33.7530000000001,33.7530000000001,0,
    35.83580000000026,35.83580000000026,0,
    37.186100000000266,37.186100000000266,0,
    37.6103999999998,37.6103999999998,0,
    38.21539999999999,38.21539999999999,0,
    38.81399999999999,38.81399999999999,0,
    39.21929999999989,39.21929999999989,0,
    39.64070000000035,39.64070000000035,0,
    39.282200000000245,39.282200000000245,0,
    38.67090000000033,38.67090000000033,0,
    38.33359999999999,38.33359999999999,0,
    38.33389999999994,38.33389999999994,0,
    38.34060000000008,38.34060000000008,0,
    38.35470000000001,38.35470000000001,0,
    38.377599999999745,38.377599999999745,0,
    38.64689999999982,38.64689999999982,0,
    39.12520000000015,39.12520000000015,0,
    39.597599999999744,39.597599999999744,0,
    39.849000000000245,39.849000000000245,0,
    39.80630000000005,39.80630000000005,0,
    39.6253999999999,39.6253999999999,0,
    39.47220000000016,39.47220000000016,0,
    39.512200000000064,39.512200000000064,0,
    40.425499999999914,40.425499999999914,0,
    42.08449999999999,42.08449999999999,0,
    43.84360000000029,43.84360000000029,0,
    45.057299999999856,45.057299999999856,0,
    45.58490000000006,45.58490000000006,0,
    46.3951999999999,46.3951999999999,0,
    47.190600000000416,47.190600000000416,0,
    47.67360000000025,47.67360000000025,0,
    48.73070000000013,48.73070000000013,0,
    49.35290000000023,49.35290000000023,0,
    49.451299999999776,49.451299999999776,0,
    48.93690000000035,48.93690000000035,0,
    45.08590000000012,45.08590000000012,0,
    38.26189999999983,38.26189999999983,0,
    31.64420000000021,31.64420000000021,0,
    28.411599999999737,28.411599999999737,0,
    28.99540000000016,28.99540000000016,0,
    30.516599999999983,30.516599999999983,0,
    32.192400000000276,32.192400000000276,0,
    33.24009999999973,33.24009999999973,0,
    33.40859999999992,33.40859999999992,0,
    33.651100000000156,33.651100000000156,0,
    33.874999999999744,33.874999999999744,0,
    33.98790000000034,33.98790000000034,0,
    33.95060000000001,33.95060000000001,0,
    33.821100000000115,33.821100000000115,0,
    33.67509999999996,33.67509999999996,0,
    33.58879999999971,33.58879999999971,0,
    33.53359999999981,33.53359999999981,0,
    33.465400000000045,33.465400000000045,0,
    33.40859999999992,33.40859999999992,0,
    33.38760000000036,33.38760000000036,0,
    33.46519999999984,33.46519999999984,0,
    33.62780000000001,33.62780000000001,0,
    33.79550000000009,33.79550000000009,0,
    33.888600000000224,33.888600000000224,0,
    33.89179999999996,33.89179999999996,0,
    33.89390000000034,33.89390000000034,0,
    33.89390000000034,33.89390000000034,0,
    33.890800000000354,33.890800000000354,0,
    33.782599999999974,33.782599999999974,0,
    33.58300000000014,33.58300000000014,0,
    33.366900000000044,33.366900000000044,0,
    33.20900000000009,33.20900000000009,0,
    33.08940000000007,33.08940000000007,0,
    32.89370000000034,32.89370000000034,0,
    32.714,32.714,0,
    32.64250000000004,32.64250000000004,0,
    33.20289999999986,33.20289999999986,0,
    34.36900000000023,34.36900000000023,0,
    35.54630000000003,35.54630000000003,0,
    36.140100000000075,36.140100000000075,0,
    35.9220999999998,35.9220999999998,0,
    35.283300000000395,35.283300000000395,0,
    34.58880000000022,34.58880000000022,0,
    34.203500000000275,34.203500000000275,0,
    34.264800000000406,34.264800000000406,0,
    34.60490000000007,34.60490000000007,0,
    34.750999999999976,34.750999999999976,0,
    34.229799999999955,34.229799999999955,0,
    32.856100000000055,32.856100000000055,0,
    30.426599999999837,30.426599999999837,0,
    28.025199999999728,28.025199999999728,0,
    26.736300000000313,26.736300000000313,0,
    26.950000000000074,26.950000000000074,0,
    27.747200000000305,27.747200000000305,0,
    28.47890000000035,28.47890000000035,0,
    28.496299999999763,28.496299999999763,0,
    24.3661000000003,24.3661000000003,0,
    17.493499999999784,17.493499999999784,0,
    10.569399999999973,10.569399999999973,0,
    6.284399999999835,6.284399999999835,0,
    6.062800000000124,6.062800000000124,0,
    6.2069999999998515,6.2069999999998515,0,
    6.411100000000403,6.411100000000403,0,
    6.369200000000319,6.369200000000319,0,
    4.588100000000139,4.588100000000139,0,
    1.3792000000002247,1.3792000000002247,0,
    -2.047799999999711,-2.047799999999711,0,
    -4.483100000000206,-4.483100000000206,0,
    -5.101599999999706,-5.101599999999706,0,
    -5.650200000000183,-5.650200000000183,0,
    -6.194899999999848,-6.194899999999848,0,
    -6.801600000000008,-6.801600000000008,0,
    -10.653800000000047,-10.653800000000047,0,
    -16.31140000000002,-16.31140000000002,0,
    -21.95910000000012,-21.95910000000012,0,
    -25.78189999999978,-25.78189999999978,0,
    -26.14680000000007,-26.14680000000007,0,
    -26.413800000000265,-26.413800000000265,0,
    -26.668399999999792,-26.668399999999792,0,
    -26.995900000000006,-26.995900000000006,0,
    -30.046000000000106,-30.046000000000106,0,
    -34.968299999999886,-34.968299999999886,0,
    -39.96959999999987,-39.96959999999987,0,
    -43.25709999999958,-43.25709999999958,0,
    -44.295999999999935,-44.295999999999935,0,
    -45.87549999999965,-45.87549999999965,0,
    -47.45509999999982,-47.45509999999982,0,
    -48.49430000000012,-48.49430000000012,0,
    -49.20150000000021,-49.20150000000021,0,
    -50.27649999999966,-50.27649999999966,0,
    -51.33200000000002,-51.33200000000002,0,
    -51.98070000000001,-51.98070000000001,0,
    -53.200499999999806,-53.200499999999806,0,
    -54.47679999999977,-54.47679999999977,0,
    -55.771899999999874,-55.771899999999874,0,
    -57.04840000000004,-57.04840000000004,0,
    -57.98079999999999,-57.98079999999999,0,
    -59.47400000000016,-59.47400000000016,0,
    -60.93019999999996,-60.93019999999996,0,
    -61.75139999999999,-61.75139999999999,0,
    -61.61949999999976,-61.61949999999976,0,
    -60.8468000000002,-60.8468000000002,0,
    -59.951699999999875,-59.951699999999875,0,
    -59.452799999999684,-59.452799999999684,0,
    -59.40530000000024,-59.40530000000024,0,
    -59.40510000000003,-59.40510000000003,0,
    -59.43990000000028,-59.43990000000028,0,
    -59.4972999999996,-59.4972999999996,0,
    -60.34299999999959,-60.34299999999959,0,
    -61.85419999999979,-61.85419999999979,0,
    -63.245400000000274,-63.245400000000274,0,
    -63.73139999999964,-63.73139999999964,0,
    -63.33890000000011,-63.33890000000011,0,
    -62.55740000000003,-62.55740000000003,0,
    -61.77369999999982,-61.77369999999982,0,
    -61.374899999999855,-61.374899999999855,0,
    -61.44990000000021,-61.44990000000021,0,
    -61.72959999999961,-61.72959999999961,0,
    -62.086699999999695,-62.086699999999695,0,
    -62.39410000000021,-62.39410000000021,0,
    -63.6963999999999,-63.6963999999999,0,
    -65.88419999999999,-65.88419999999999,0,
    -68.10139999999976,-68.10139999999976,0,
    -69.49180000000013,-69.49180000000013,0,
    -70.26540000000026,-70.26540000000026,0,
    -71.34440000000026,-71.34440000000026,0,
    -72.43950000000012,-72.43950000000012,0,
    -73.26130000000006,-73.26130000000006,0,
    -73.76659999999973,-73.76659999999973,0,
    -74.57550000000026,-74.57550000000026,0,
    -75.35489999999996,-75.35489999999996,0,
    -75.77190000000016,-75.77190000000016,0,
    -74.84290000000016,-74.84290000000016,0,
    -71.56200000000013,-71.56200000000013,0,
    -68.1834000000002,-68.1834000000002,0,
    -66.96140000000028,-66.96140000000028,0,
    -67.95089999999959,-67.95089999999959,0,
    -69.86699999999999,-69.86699999999999,0,
    -71.7295,-71.7295,0,
    -72.55809999999983,-72.55809999999983,0,
    -72.4148999999997,-72.4148999999997,0,
    -72.09379999999967,-72.09379999999967,0,
    -71.74890000000005,-71.74890000000005,0,
    -71.53449999999992,-71.53449999999992,0,
    -71.10350000000025,-71.10350000000025,0,
    -70.50899999999984,-70.50899999999984,0,
    -69.92049999999992,-69.92049999999992,0,
    -69.50730000000007,-69.50730000000007,0,
    -68.67499999999964,-68.67499999999964,0,
    -67.34969999999976,-67.34969999999976,0,
    -66.11830000000012,-66.11830000000012,0,
    -65.56769999999972,-65.56769999999972,0,
    -67.15979999999959,-67.15979999999959,0,
    -70.77400000000011,-70.77400000000011,0,
    -74.53980000000016,-74.53980000000016,0,
    -76.58670000000001,-76.58670000000001,0,
    -76.62079999999989,-76.62079999999989,0,
    -76.53990000000022,-76.53990000000022,0,
    -76.38609999999986,-76.38609999999986,0,
    -76.20160000000027,-76.20160000000027,0,
    -75.14169999999964,-75.14169999999964,0,
    -73.31289999999981,-73.31289999999981,0,
    -71.43670000000029,-71.43670000000029,0,
    -70.23530000000022,-70.23530000000022,0,
    -68.85029999999972,-68.85029999999972,0,
    -66.79650000000024,-66.79650000000024,0,
    -64.8896999999998,-64.8896999999998,0,
    -63.94599999999997,-63.94599999999997,0,
    -64.32590000000005,-64.32590000000005,0,
    -65.30350000000027,-65.30350000000027,0,
    -66.23349999999988,-66.23349999999988,0,
    -66.47049999999979,-66.47049999999979,0,
    -65.46829999999986,-65.46829999999986,0,
    -63.63640000000004,-63.63640000000004,0,
    -61.79289999999966,-61.79289999999966,0,
    -60.75579999999974,-60.75579999999974,0,
    -60.791900000000254,-60.791900000000254,0,
    -61.22779999999963,-61.22779999999963,0,
    -61.723099999999675,-61.723099999999675,0,
    -61.93760000000026,-61.93760000000026,0,
    -61.599199999999854,-61.599199999999854,0,
    -60.90829999999983,-60.90829999999983,0,
    -60.219299999999976,-60.219299999999976,0,
    -59.886799999999596,-59.886799999999596,0,
    -60.02459999999985,-60.02459999999985,0,
    -60.34059999999997,-60.34059999999997,0,
    -60.62870000000018,-60.62870000000018,0,
    -60.682800000000015,-60.682800000000015,0,
    -59.612200000000115,-59.612200000000115,0,
    -57.63210000000001,-57.63210000000001,0,
    -55.59820000000002,-55.59820000000002,0,
    -54.366199999999765,-54.366199999999765,0,
    -54.27499999999981,-54.27499999999981,0,
    -54.16979999999967,-54.16979999999967,0,
    -54.06860000000009,-54.06860000000009,0,
    -53.98909999999972,-53.98909999999972,0,
    -50.38199999999975,-50.38199999999975,0,
    -44.46140000000014,-44.46140000000014,0,
    -38.371899999999926,-38.371899999999926,0,
    -34.258299999999764,-34.258299999999764,0,
    -33.96249999999981,-33.96249999999981,0,
    -33.502999999999616,-33.502999999999616,0,
    -33.038799999999924,-33.038799999999924,0,
    -32.72890000000004,-32.72890000000004,0,
    -28.758099999999587,-28.758099999999587,0,
    -22.65429999999995,-22.65429999999995,0,
    -16.480200000000167,-16.480200000000167,0,
    -12.29849999999999,-12.29849999999999,0,
    -11.609800000000092,-11.609800000000092,0,
    -10.611000000000104,-10.611000000000104,0,
    -9.634899999999647,-9.634899999999647,0,
    -9.014400000000222,-9.014400000000222,0,
    -8.046099999999967,-8.046099999999967,0,
    -6.653800000000132,-6.653800000000132,0,
    -5.27359999999959,-5.27359999999959,0,
    -4.341399999999851,-4.341399999999851,0
    ];
    
    var inInds=[0,1,2,3,4,5,6, 7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280];
     var outInds=[281 ,282 ,283 ,284 ,285 ,286 ,287 ,288 ,289 ,290 ,291 ,292 ,293 ,294 ,295 ,296 ,297 ,298 ,299 ,300 ,301 ,302 ,303 ,304 ,305 ,306 ,307 ,308 ,309 ,310 ,311 ,312 ,313 ,314 ,315 ,316 ,317 ,318 ,319 ,320 ,321 ,322 ,323 ,324 ,325 ,326 ,327 ,328 ,329 ,330 ,331 ,332 ,333 ,334 ,335 ,336 ,337 ,338 ,339 ,340 ,341 ,342 ,343 ,344 ,345 ,346 ,347 ,348 ,349 ,350 ,351 ,352 ,353 ,354 ,355 ,356 ,357 ,358 ,359 ,360 ,361 ,362 ,363 ,364 ,365 ,366 ,367 ,368 ,369 ,370 ,371 ,372 ,373 ,374 ,375 ,376 ,377 ,378 ,379 ,380 ,381 ,382 ,383 ,384 ,385 ,386 ,387 ,388 ,389 ,390 ,391 ,392 ,393 ,394 ,395 ,396 ,397 ,398 ,399 ,400 ,401 ,402 ,403 ,404 ,405 ,406 ,407 ,408 ,409 ,410 ,411 ,412 ,413 ,414 ,415 ,416 ,417 ,418 ,419 ,420 ,421 ,422 ,423 ,424 ,425 ,426 ,427 ,428 ,429 ,430 ,431 ,432 ,433 ,434 ,435 ,436 ,437 ,438 ,439 ,440 ,441 ,442 ,443 ,444 ,445 ,446 ,447 ,448 ,449 ,450 ,451 ,452 ,453 ,454 ,455 ,456 ,457 ,458 ,459 ,460 ,461 ,462 ,463 ,464 ,465 ,466 ,467 ,468 ,469 ,470 ,471 ,472 ,473 ,474 ,475 ,476 ,477 ,478 ,479 ,480 ,481 ,482 ,483 ,484 ,485 ,486 ,487 ,488 ,489 ,490 ,491 ,492 ,493 ,494 ,495 ,496 ,497 ,498 ,499 ,500 ,501 ,502 ,503 ,504 ,505 ,506 ,507 ,508 ,509 ,510 ,511 ,512 ,513 ,514 ,515 ,516 ,517 ,518 ,519 ,520 ,521 ,522 ,523 ,524 ,525 ,526 ,527 ,528 ,529 ,530 ,531 ,532 ,533 ,534 ,535 ,536 ,537 ,538 ,539 ,540 ,541 ,542 ,543 ,544 ,545 ,546 ,547 ,548 ,549 ,550 ,551 ,552 ,553 ,554 ,555 ,556 ,557];
var createInds = function(indices,innerInds, outInds){
    var innerSize = innerInds.length;
    var outSize = outInds.length;
    var size = Math.max(innerSize,outSize);
    for(var i = 0;  i< size-1; i++){
        
        var indI = i> innerSize-2?innerSize-2:i;
        var outI = i> outSize -2?outSize-2:i;
        indices.push(innerInds[indI],outInds[outI],innerInds[indI+1]);
        indices.push(outInds[outI],outInds[outI+1],innerInds[indI+1]);
    }

}

var indices = [];
var inSize = inInds.length; var outSize =outInds.length;
createInds(indices,inInds,outInds);
console.log("length==",posArr.length/3,inInds.length,outInds.length);
//console.log("indices = ",indices);
var getDist = function(x1,y1,x2,y2){
    return Math.sqrt(
       (x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));
};

var findMinDistance = function(posArr,ind,indices){
    var x1 = posArr[ind*3];
    var y1 = posArr[ind*3+1];
    var dist = 1000000000.0;
    var resi = -1;
    for(var i = 0; i < indices.length; i++){
        var x2 = posArr[indices[i]*3];
        var y2 = posArr[indices[i]*3+1];
        var d = getDist(x1,y1,x2,y2);
        if(d<dist){
            dist = d;
            resi = indices[i];
        }
    }
    return [resi,dist];
};

var max = 10.0;
var getRG = function(disArr,ind,vertArr){
    var rmax = 0.0;
    var gmin = 0.0;
    var pairId = -1;
    if(inInds.indexOf(ind)!=-1){ 
        pairId = findMinDistance(vertArr,ind,outInds)[0];
        rmax = disArr[pairId];
        gmin = disArr[ind];
    }else{
        pairId = findMinDistance(vertArr,ind,inInds)[0];
        rmax = disArr[ind];
        gmin = disArr[pairId];
    }
   
    return [rmax,gmin];
};

var colors =[];
var dists = [];
for (var id = 0; id <(inSize); id++){
    var dist = getDist(mid[0],mid[1],posArr[inInds[id]*3],posArr[inInds[id]*3+1])/max;
    dists[inInds[id]] = dist;
}
for (var idj = 0; idj <(outSize); idj++){
    var dist = getDist(mid[0],mid[1],posArr[outInds[idj]*3],posArr[outInds[idj]*3+1])/max;
    dists[outInds[idj]] = dist;
}
//   var colors = [0.6,0.4,1.0,1.0,
//                 0.6,0.4,1.0,1.0,
//                 0.6,0.4,1.0,1.0,
//                 0.6,0.4,1.0,1.0,];
var RMaxAvg = 0.0;
var RMinAvg = 0.0;
for(var ic = 0; ic<inInds.length; ic++){
    var rg = getRG(dists,inInds[ic],posArr);
    console.log(" index=",inInds[ic]," rmax=",rg[0]," rmin=",rg[1]);
    colors.push(rg[0],rg[1],1.0,1.0);
    RMaxAvg += rg[0];
    RMinAvg += rg[1];
}
for(var ic = 0; ic<outInds.length; ic++){
    var rg = getRG(dists,outInds[ic],posArr);
    console.log(" index=",outInds[ic]," rmax=",rg[0]," rmin=",rg[1]);
    colors.push(rg[0],rg[1],1.0,1.0);
    RMaxAvg += rg[0];
    RMinAvg += rg[1];
}
RMaxAvg = RMaxAvg/(inSize + outSize);
RMinAvg = RMinAvg/(inSize + outSize);
console.log("max min ==", RMaxAvg,RMinAvg);
console.log(dists);
console.log(colors);
console.log("color length=",colors.length);
// var colors = [dists,1.6,1.0,1.0,
//     2.45,1.55,1.0,1.0,
//     2.6,1.5,1.0,1.0,
//     2.48,1.1,1.0,1.0];

// var indices = [0,1,3,3,1,2];

var mesh = Mad3D.MeshUtil.createColorPolygon(colors,indices,posArr);
  //var mesh = MeshUtil.createColorPlane(2,2,colors,0);
    /**@type {Material} */
    var material = Mad3D.MaterialUtil.createFromShader(vsSource,fsSource);
    material.shaderOption.vertexColor = true;
    material.setUniform("u_mouse",Mad3D.UTypeEnumn.Vec2,mid);
   // material.shaderOption.cullFace = "FRONT";
   // console.log("resolution",w,h);
    material.setUniform("u_resolution",Mad3D.UTypeEnumn.Vec2,[RMaxAvg,RMinAvg]);
    mdg.mat = material;
    //var ets = [];
    var entity = new Mad3D.Entity("t1");
    entity.mesh = mesh;
    entity.material = material;
    
    
    return entity;
}
function initScene(){
    //default scene
     var ds = Mad3D.SceneUtil.createDefaultScene("sipc",{hasSkyBox:false,castShadow:false});
    
     ds.camera.clearColor = [0.0,0.0,0.0,1.0];
    
    //  ds.scene.ambientLight = new Vector3(0.02,0.02,0.02);
    //  //light
    //  var lt = ds.dirLight;
    //  lt.color = new Vector3(1.0,1.0,1.0);
    //  lt.specular = new Vector3(1.0,1.0,1.0);
 
    var baseUrl = "../pics/MD3d_hello.png";      
    
       var smesh = Mad3D.MeshUtil.createBox(3,3,3);
       var enti1 =Mad3D.SceneUtil.createEntity(ds.scene,"box",
       {mesh:smesh,receiveLight:false,receiveShadow:false,
          texture0:baseUrl
          });
 
    ds.scene.addEntity(enti1);
   
    ds.scene.addEntity(createPolygonEntity());
     //interaction
    Mad3D.InteractUtil.registerCameraMove(ds.camera,ds.scene.gl.canvas,function(trans){ 
    });
 
    return ds.scene;
 }

 function main(){
    var scene = initScene();
    //scene.enableActiveDraw(true);
    scene.draw();
    
}


window.onload = main;



